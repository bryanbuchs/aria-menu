<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>ARIA 1.1 Menubar/Popup example</title>
	<link rel="stylesheet" href="menu.css" />
</head>
<body>
	
	<header>
		<nav class="utility-menu">
			<div class="utility-menu__inner">
				<div class="utility-menu__item">
					<button
						data-js-popup-button
						id="account-menu-button"
						aria-haspopup="true"
						aria-controls="account-popup-menu"
					>
						My account
					</button>
					<div
						class="popup-menu _bottom"
						id="account-popup-menu"
						aria-labelledby="account-menu-button"
					>
						<ul role="menu" class="popup-menu__list">
							<li role="none" class="popup-menu__item">
								<a role="menuitem" href="#">Orders</a>
							</li>
							<li role="none" class="popup-menu__item">
								<a role="menuitem" href="#">Change password</a>
							</li>
						</ul>
						<div role="none" class="popup-menu__tail"></div>
					</div>
				</div>
				<div class="utility-menu__item">
					<button
						data-js-popup-button
						id="orders-menu-button"
						aria-haspopup="true"
						aria-controls="orders-popup-menu"
					>
						Orders
					</button>
					<div
						class="popup-menu _bottom"
						id="orders-popup-menu"
						aria-labelledby="orders-menu-button"
					>
						<ul role="menu" class="popup-menu__list">
							<li role="none" class="popup-menu__item">
								<a role="menuitem" href="#">Orders</a>
							</li>
							<li role="none" class="popup-menu__item">
								<a role="menuitem" href="#">Change password</a>
							</li>
						</ul>
						<div role="none" class="popup-menu__tail"></div>
					</div>
				</div>
			</div>
		</nav>
		
		<nav
			role="navigation"
			class="menu-bar"
			data-js-nav
			aria-label="Main menu"
			itemscope=""
			itemtype="http://www.schema.org/SiteNavigationElement"
		>
			<ul
				role="menubar"
				class="menu-bar__inner"
				data-js-menu-bar
			>
				<li role="none" class="menu-bar__item">
					<a
						role="menuitem"
						class="menu-bar__link _level-1"
						aria-haspopup="true"
						aria-expanded="false"
						itemprop="url"
						href="./menu-a.html"
					>
						<span itemprop="name">Menu A</span>
					</a>
					<div role="menu" class="menu-bar__popup" data-js-nav-flyout>
						<ul class="menu-bar__popup-inner">
							<li role="none" class="menu-bar__submenu-item">
								<a
									role="menuitem"
									class="menu-bar__link _level-2"
									itemprop="url"
									href="/menu-a-i.html"
								>
									<span itemprop="name">Menu A I</span>
								</a>
							</li>
							<li role="none" class="menu-bar__submenu-item">
								<a
									role="menuitem"
									class="menu-bar__link _level-2"
									itemprop="url"
									href="/menu-a-ii.html"
								>
									<span itemprop="name">Menu A II</span>
								</a>
							</li>
							<li role="none" class="menu-bar__submenu-item">
								<a
									role="menuitem"
									class="menu-bar__link _level-2"
									itemprop="url"
									href="/menu-a-iii.html"
								>
									<span itemprop="name">Menu A III</span>
								</a>
							</li>
						</ul>
					</div>
				</li>
				<li role="none" class="menu-bar__item">
					<a
						role="menuitem"
						class="menu-bar__link _level-1"
						aria-haspopup="true"
						aria-expanded="false"
						itemprop="url"
						href="./menu-b.html"
					>
						<span itemprop="name">Menu B</span>
					</a>
					<div role="menu" class="menu-bar__popup" data-js-nav-flyout>
						<ul class="menu-bar__popup-inner">
							<li role="none" class="menu-bar__submenu-item">
								<a
									role="menuitem"
									class="menu-bar__link _level-2"
									itemprop="url"
									href="/menu-b-i.html"
								>
									<span itemprop="name">Menu B I</span>
								</a>
							</li>
							<li role="none" class="menu-bar__submenu-item">
								<a
									role="menuitem"
									class="menu-bar__link _level-2"
									itemprop="url"
									href="/menu-b-ii.html"
								>
									<span itemprop="name">Menu B II</span>
								</a>
							</li>
							<li role="none" class="menu-bar__submenu-item">
								<a
									role="menuitem"
									class="menu-bar__link _level-2"
									itemprop="url"
									href="/menu-b-iii.html"
								>
									<span itemprop="name">Menu B III</span>
								</a>
							</li>
							<li role="none" class="menu-bar__submenu-item">
								<a
									role="menuitem"
									class="menu-bar__link _level-2"
									itemprop="url"
									href="/menu-b-iv.html"
								>
									<span itemprop="name">Menu B IV</span>
								</a>
							</li>
						</ul>
					</div>
				</li>
				<li role="none" class="menu-bar__item">
					<a
						role="menuitem"
						class="menu-bar__link _level-1"
						aria-haspopup="true"
						aria-expanded="false"
						itemprop="url"
						href="./menu-c.html"
					>
						<span itemprop="name">Menu C</span>
					</a>
					<div role="menu" class="menu-bar__popup" data-js-nav-flyout>
						<ul class="menu-bar__popup-inner">
							<li role="none" class="menu-bar__submenu-item">
								<a
									role="menuitem"
									class="menu-bar__link _level-2"
									itemprop="url"
									href="/menu-c-i.html"
								>
									<span itemprop="name">Menu C I</span>
								</a>
							</li>
							<li role="none" class="menu-bar__submenu-item">
								<a
									role="menuitem"
									class="menu-bar__link _level-2"
									itemprop="url"
									href="/menu-c-ii.html"
								>
									<span itemprop="name">Menu C II</span>
								</a>
							</li>
						</ul>
					</div>
				</li>
				<li role="none" class="menu-bar__item">
					<a
						role="menuitem"
						class="menu-bar__link _level-1"
						itemprop="url"
						href="./menu-d.html"
					>
						<span itemprop="name">Menu D</span>
					</a>
				</li>
				<li role="none" class="menu-bar__item">
					<a
						role="menuitem"
						class="menu-bar__link _level-1"
						itemprop="url"
						href="./menu-e.html"
					>
						<span itemprop="name">Menu E</span>
					</a>
				</li>
				<li role="none" class="menu-bar__flyout-pane" data-js-menu-flyout-pane></li>
			</ul>
		</nav>
	
	</header>
	
	<main>
		<a href="">Link</a>
	</main>
	
	<script type="module">
		import { Menubar } from './index.js';
		//import Hamburger from './HamburgerMenu.js'
		
		const mobileNav = document.querySelector('[data-js-nav]');
		const desktopNav = document.querySelector('[data-js-menu-bar]');
		
		if (mobileNav && desktopNav) {
			const bar = new Menubar(desktopNav);
			//const hamburger = new Hamburger(mobileNav);
			
			let isBarInited = false;
			let isHamburgerInited = false;
			const initBar = () => {
				bar.init();
				isBarInited = true;
			};
			const initHamburger = () => {
				//hamburger.init();
				isHamburgerInited = true;
			};
			
			let lastBreakpoint;
			const getBreakpoint = () => {
				const isDesktop = (window.innerWidth >= 1024);
				const currentBreakpoint = isDesktop ? 'desktop' : 'mobile';
				
				if (currentBreakpoint === lastBreakpoint) {
					return '';
				}
				lastBreakpoint = currentBreakpoint;
				return currentBreakpoint;
			};
			
			const toggleNavigation = () => {
				const breakP = getBreakpoint();
				
				if (breakP === 'desktop') {
					if (isHamburgerInited) {
						//hamburger.destroy();
					}
					initBar();
				}
				
				if (breakP === 'mobile') {
					if (isBarInited) {
						bar.destroy();
					}
					initHamburger();
				}
			};
			
			if (window.innerWidth >= 1024) {
				initBar();
			} else {
				initHamburger();
			}
			
			window.addEventListener('resize', toggleNavigation);
		}
	</script>
	
	
	<script type="module">
		import { Popup } from './index.js';
		document.querySelectorAll('[data-js-popup-button]')
			.forEach(popupButton => new Popup(popupButton).init());
	</script>
	
</body>
</html>
